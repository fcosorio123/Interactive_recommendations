<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sprint 2025 Financial Plan</title>
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* CSS Variables for consistency */
    :root {
      --primary-color: #0077cc;
      --primary-dark: #005fa3;
      --secondary-color: #27ae60;
      --accent-color: #ffc107;
      --bg-color: #f0f2f5;
      --container-bg: #fff;
      --border-color: #ddd;
      --shadow-color: rgba(0, 0, 0, 0.1);
      --transition-speed: 0.3s;
    }

    /* Global Styles */
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background: var(--bg-color);
      color: #333;
    }
    header {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      color: #fff;
      padding: 30px 20px;
      text-align: center;
      box-shadow: 0 4px 6px var(--shadow-color);
    }
    header h1 {
      margin: 0;
      font-size: 2.5em;
      letter-spacing: 1px;
    }
    header h3 {
      margin: 10px 0 0;
      font-weight: 400;
    }
    .container {
      max-width: 1200px;
      margin: 30px auto;
      background: var(--container-bg);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px var(--shadow-color);
    }
    .section-title {
      border-bottom: 3px solid var(--primary-color);
      padding-bottom: 8px;
      margin-bottom: 20px;
      font-size: 1.8em;
      color: var(--primary-color);
    }
    p {
      line-height: 1.6;
    }
    /* Tabs */
    .tab-container {
      margin-bottom: 20px;
    }
    .tabs {
      display: flex;
      border-bottom: 2px solid var(--border-color);
      margin-bottom: 10px;
    }
    .tab-button {
      padding: 10px 20px;
      cursor: pointer;
      border: none;
      background: none;
      font-size: 1em;
      color: var(--primary-color);
      border-bottom: 3px solid transparent;
      transition: border-color var(--transition-speed);
    }
    .tab-button.active {
      border-bottom: 3px solid var(--primary-color);
      font-weight: bold;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    /* Learn Section */
    .diagnosis, .observations, .recommendations {
      margin-bottom: 25px;
    }
    .diagnosis h3, .observations h3, .recommendations h3 {
      margin-bottom: 10px;
      color: var(--primary-dark);
    }
    #diagnosisText strong {
      font-weight: bold;
    }
    /* Financial Health Gauge */
    .health-meter-container {
      margin: 20px 0;
      text-align: center;
    }
    .health-meter-container label {
      font-size: 1.2em;
      display: block;
      margin-bottom: 10px;
    }
    #healthGauge {
      max-width: 250px;
      margin: 0 auto;
    }
    .risk-notes {
      font-size: 0.9em;
      margin-top: 8px;
      color: #555;
    }
    /* Observations Charts */
    .charts-container, .additional-charts {
      display: flex;
      justify-content: space-around;
      gap: 20px;
      margin-top: 20px;
      flex-wrap: wrap;
    }
    .chart-box {
      flex: 1;
      max-width: 600px;
      margin: 10px;
    }
    /* Observations Data Items */
    .observations .data-item {
      padding: 8px 0;
      border-bottom: 1px solid var(--border-color);
      position: relative;
    }
    .observations .data-item:last-child {
      border-bottom: none;
    }
    .observations .data-item > span {
      font-weight: 500;
    }
    .toggle-icon {
      cursor: pointer;
      margin-left: 10px;
      font-size: 1.1em;
      color: var(--primary-color);
    }
    .sub-values {
      display: none;
      padding: 5px 20px;
      font-size: 0.9em;
      color: #666;
      background: #f9f9f9;
      border-left: 3px solid var(--primary-color);
      margin-top: 5px;
    }
    /* Act Section */
    .global-progress-container {
      background: var(--border-color);
      border-radius: 5px;
      overflow: hidden;
      height: 15px;
      margin-bottom: 10px;
    }
    .global-progress {
      height: 15px;
      width: 0%;
      background: var(--secondary-color);
      transition: width 0.5s ease;
    }
    .sort-controls {
      margin-bottom: 15px;
    }
    .sort-controls label {
      font-weight: bold;
      margin-right: 10px;
    }
    .action-item {
      border: 1px solid var(--border-color);
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      background: #fafafa;
      transition: background-color var(--transition-speed);
    }
    .action-item.completed {
      text-decoration: line-through;
      opacity: 0.7;
      background-color: #e0e0e0;
    }
    .action-item .priority-indicator {
      display: inline-block;
      padding: 4px 10px;
      background: var(--accent-color);
      border-radius: 4px;
      font-size: 0.9em;
      margin-right: 10px;
      color: #fff;
    }
    .action-item h4 {
      margin: 0 0 10px;
      color: #333;
    }
    .action-button {
      background-color: var(--primary-color);
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1em;
      margin-top: 10px;
      transition: background-color var(--transition-speed);
    }
    .action-button:hover {
      background-color: var(--primary-dark);
    }
    .resource-list {
      margin-top: 15px;
      display: none;
      padding: 10px;
      background: #f9f9f9;
      border: 1px solid var(--border-color);
      border-radius: 5px;
    }
    .resource-list h5 {
      margin-top: 0;
      color: var(--primary-color);
    }
    .resource-list ul {
      list-style-type: none;
      padding-left: 0;
    }
    .resource-list li {
      margin-bottom: 8px;
    }
    .resource-list li a {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
      transition: color var(--transition-speed);
    }
    .resource-list li a:hover {
      text-decoration: underline;
      color: var(--primary-dark);
    }
    /* Priority Labels for Recommendations */
    .priority-high {
      background-color: red !important;
      color: white !important;
      padding: 2px 6px;
      border-radius: 3px;
      margin-right: 5px;
      font-weight: bold;
    }
    .priority-medium {
      background-color: yellow !important;
      color: black !important;
      padding: 2px 6px;
      border-radius: 3px;
      margin-right: 5px;
      font-weight: bold;
    }
    .priority-low {
      background-color: green !important;
      color: white !important;
      padding: 2px 6px;
      border-radius: 3px;
      margin-right: 5px;
      font-weight: bold;
    }
    /* Recommendations */
    .recommendations h4 {
      margin: 10px 0 5px;
      color: var(--primary-color);
    }
    .recommendations li {
      margin-bottom: 8px;
    }
    /* Chatbot */
    .chatbot {
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 20px;
      background: #fff;
      margin-top: 20px;
      position: relative;
      box-shadow: 0 2px 4px var(--shadow-color);
    }
    .chatbot h3 {
      margin-top: 0;
      color: var(--primary-color);
    }
    .chat-log {
      height: 200px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      padding: 10px;
      margin-bottom: 15px;
      background: #f9f9f9;
    }
    .chat-log p {
      margin: 5px 0;
    }
    .chat-input {
      display: flex;
      align-items: center;
    }
    .chat-input input {
      flex: 1;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 1em;
      transition: border-color var(--transition-speed);
    }
    .chat-input input:focus {
      border-color: var(--primary-color);
      outline: none;
    }
    .chat-input button {
      margin-left: 10px;
      padding: 10px 15px;
      background-color: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1em;
      transition: background-color var(--transition-speed);
    }
    .chat-input button:hover {
      background-color: var(--primary-dark);
    }
    .predetermined-questions {
      margin-top: 15px;
    }
    .predetermined-questions button {
      background: #e0e0e0;
      border: none;
      padding: 8px 12px;
      border-radius: 20px;
      margin-right: 10px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: background var(--transition-speed);
    }
    .predetermined-questions button:hover {
      background: #d0d0d0;
    }
    /* Resources Carousel */
    .carousel {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding: 10px 0;
    }
    .resource-card {
      position: relative;
      min-width: 250px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      padding: 15px;
      background: #fff;
      flex-shrink: 0;
      box-shadow: 0 2px 4px var(--shadow-color);
      transition: transform var(--transition-speed);
    }
    .resource-card:hover {
      transform: translateY(-3px);
    }
    .resource-card.recommended {
      border-color: var(--secondary-color);
    }
    .resource-card .badge {
      background-color: var(--secondary-color) !important;
      color: #fff !important;
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 3px 6px;
      border-radius: 3px;
      font-size: 0.8em;
      display: inline-block;
    }
    .resource-card h4 {
      margin-top: 0;
      color: var(--primary-color);
    }
    .resource-card a {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
      transition: color var(--transition-speed);
    }
    .resource-card a:hover {
      text-decoration: underline;
      color: var(--primary-dark);
    }
    /* Tree Mascot */
    .tree-mascot {
      display: block;
      margin: 0 auto 10px;
      width: 80px;
    }
    /* Chart Sizing */
    #chartCollegeBill, #chartRemaining, #chartCapacity, #chartLivingExpenses, #chartFunding, #simulationChart {
      max-width: 600px;
      height: 400px;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <!-- Header Section -->
  <header>
    <h1 title="Your financial plan for this semester">Sprint 2025 Financial Plan</h1>
    <h3 title="Your remaining funds after all expenses">Remaining Balance: <span id="globalRemainingBalance">$-800</span></h3>
  </header>

  <!-- Learn Section -->
  <div class="container" id="learn-section">
    <h2 class="section-title" title="Overview of your college money plan">Learn</h2>
    
    <!-- Cumulative Diagnosis -->
    <div class="diagnosis">
      <h3 title="Summary of your overall financial health">Cumulative Diagnosis</h3>
      <p id="diagnosisText" title="This summarizes your current financial status based on your plan">
        <strong>Your financial health</strong> is moderate.
      </p>
      <!-- Gauge Chart for Financial Health Score -->
      <div class="health-meter-container">
        <label for="healthGauge" title="Your current financial health score (from 1 to 10)"><strong>Financial Health Score:</strong></label>
        <canvas id="healthGauge" title="Gauge showing 6/10"></canvas>
      </div>
      <div class="risk-notes" title="Note: Primary risk compares your direct funding vs. direct expenses; Secondary risk includes all items">
        Note: Primary Risk (Direct Funding vs. Direct Expenses)...  |  Secondary Risk (Overall including indirect items)...
      </div>
    </div>
    
    <!-- Cumulative Observations -->
    <div class="observations">
      <h3 title="Key financial numbers for your plan">Cumulative Observations</h3>
      <p title="Overview of your cumulative financial metrics">
        Below are the key observations from your financial plan.
      </p>
      <div class="tab-container" id="observationsTabs" title="Switch between system and coach observations">
        <div class="tabs">
          <button class="tab-button active" data-tab="observationsArbol">Arbol</button>
          <button class="tab-button" data-tab="observationsCoach">Financial Coach</button>
        </div>
        <div id="observationsArbol" class="tab-content active">
          <!-- Arbol Observations -->
          <div class="data-item" title="Total funds from all sources">
            <span>Total Inflows: <strong id="totalInflows">$3,000</strong></span>
            <span class="toggle-icon" onclick="toggleSubValues(this)" title="Click to see breakdown">&#x25B6;</span>
            <div class="sub-values">
              Financial Aid: $1,000<br>
              Employment Income: $1,000<br>
              Family &amp; Friend Support: $1,000
            </div>
          </div>
          <div class="data-item" title="Total expenses incurred">
            <span>Total Outflows: <strong id="totalOutflows">$3,800</strong></span>
            <span class="toggle-icon" onclick="toggleSubValues(this)" title="Click to see breakdown">&#x25B6;</span>
            <div class="sub-values">
              Tuition &amp; Fees: $2,000<br>
              Living Expenses: $1,800
            </div>
          </div>
          <div class="data-item" title="College Bill = Direct Funding - Direct Expenses">
            <span>College Bill: <strong id="collegeBill">$-1,000</strong></span>
            <span class="toggle-icon" onclick="toggleSubValues(this)" title="Click to see breakdown">&#x25B6;</span>
            <div class="sub-values">
              Direct Funding (Financial Aid): $1,000<br>
              Direct Expenses (Tuition &amp; Fees): $2,000
            </div>
          </div>
          <div class="data-item" title="Remaining Balance = Total Inflows - Total Outflows">
            <span>Remaining Balance: <strong id="remainingBalance2"></strong></span>
            <span class="toggle-icon" onclick="toggleSubValues(this)" title="Click to see calculation">&#x25B6;</span>
            <div class="sub-values">
              (Computed as Total Inflows – Total Outflows)
            </div>
          </div>
          <div class="data-item" title="Funds currently available">
            <span>Current Capacity: <strong id="currentCapacity">$3,000</strong></span>
            <span class="toggle-icon" onclick="toggleSubValues(this)" title="Click for details">&#x25B6;</span>
            <div class="sub-values">
              (Cash, savings, etc.)
            </div>
          </div>
          <div class="data-item" title="Potential funds available with optimization">
            <span>Max Capacity: <strong id="maxCapacity">$4,000</strong></span>
            <span class="toggle-icon" onclick="toggleSubValues(this)" title="Click for details">&#x25B6;</span>
            <div class="sub-values">
              (Potential improvements with additional funding or cost-cutting)
            </div>
          </div>
        </div>
        <div id="observationsCoach" class="tab-content">
          <!-- Financial Coach Observations -->
          <div class="data-item" title="Coach observation on dining expenses">
            <span>Observation: Monitor Dining Out Expenses</span>
            <span class="toggle-icon" onclick="toggleSubValues(this)" title="Click for details">&#x25B6;</span>
            <div class="sub-values">
              Your coach noticed high spending on dining out. Consider preparing more meals at home.
            </div>
          </div>
          <div class="data-item" title="Coach observation on subscriptions">
            <span>Observation: Evaluate Subscriptions</span>
            <span class="toggle-icon" onclick="toggleSubValues(this)" title="Click for details">&#x25B6;</span>
            <div class="sub-values">
              Review your recurring subscriptions and cancel those you rarely use.
            </div>
          </div>
        </div>
      </div>
      
      <!-- Observations Charts -->
      <div class="charts-container">
        <div class="chart-box">
          <canvas id="chartCollegeBill" title="Direct Funding vs. Direct Expenses"></canvas>
          <p style="text-align:center; font-size:0.9em;">College Bill Breakdown</p>
        </div>
        <div class="chart-box">
          <canvas id="chartRemaining" title="Outflows vs. Remaining Balance"></canvas>
          <p style="text-align:center; font-size:0.9em;">Remaining Balance Breakdown</p>
        </div>
        <div class="chart-box">
          <canvas id="chartCapacity" title="Current vs. Max Capacity"></canvas>
          <p style="text-align:center; font-size:0.9em;">Capacity Comparison</p>
        </div>
      </div>
      <div class="additional-charts">
        <div class="chart-box">
          <canvas id="chartLivingExpenses" title="Breakdown of Living Expenses"></canvas>
          <p style="text-align:center; font-size:0.9em;">Living Expenses Breakdown</p>
        </div>
        <div class="chart-box">
          <canvas id="chartFunding" title="Breakdown of Funding Sources"></canvas>
          <p style="text-align:center; font-size:0.9em;">Funding Breakdown</p>
        </div>
      </div>
    </div>
    
    <!-- Cumulative Recommendations -->
    <h3 title="Overall recommendations to improve your financial outlook">Cumulative Recommendations</h3>
    <div class="tab-container" id="recommendationsTabs" title="Switch between system and coach recommendations">
      <div class="tabs">
        <button class="tab-button active" data-tab="recommendationsArbol">Arbol</button>
        <button class="tab-button" data-tab="recommendationsCoach">Financial Coach</button>
      </div>
      <div id="recommendationsArbol" class="tab-content active">
        <h4 title="System suggestions to boost funding">Increasing Inflows</h4>
        <ul title="System suggestions">
          <li><span class="priority-high" title="High priority">High</span>Apply for Pell Grant to potentially increase funding by $1,000. This will improve your Remaining Balance and boost your Financial Health Score.</li>
          <li><span class="priority-medium" title="Medium priority">Medium</span>Investigate additional scholarship opportunities to enhance your funding, which will improve your Remaining Balance and overall Financial Health Score.</li>
        </ul>
        <h4 title="System suggestions to reduce expenses">Reducing Outflows</h4>
        <ul title="System suggestions">
          <li><span class="priority-high" title="High priority">High</span>Review tuition fee waiver options to reduce direct expenses by $500. This reduction will improve your Remaining Balance and enhance your Financial Health Score.</li>
          <li><span class="priority-medium" title="Medium priority">Medium</span>Optimize your living expenses to lower costs, thereby increasing your Remaining Balance and improving your Financial Health Score.</li>
          <li><span class="priority-low" title="Low priority">Low</span>Consult with a financial advisor for targeted cost reduction strategies to further boost your Remaining Balance and overall Financial Health Score.</li>
        </ul>
      </div>
      <div id="recommendationsCoach" class="tab-content">
        <h4 title="Coach recommendations to boost funding">Increasing Inflows</h4>
        <ul title="Coach suggestions">
          <li><span class="priority-high" title="High priority">High</span>Schedule a meeting with your financial coach to review scholarship options tailored to your profile. This personalized approach will improve your Remaining Balance and Financial Health Score.</li>
        </ul>
        <h4 title="Coach recommendations to reduce expenses">Reducing Outflows</h4>
        <ul title="Coach suggestions">
          <li><span class="priority-medium" title="Medium priority">Medium</span>Discuss a personalized budget plan with your coach to reduce discretionary spending, leading to an improved Remaining Balance and Financial Health Score.</li>
        </ul>
      </div>
    </div>
  </div>
  
  <!-- Act Section -->
  <div class="container" id="act-section" title="Take action on your plan">
    <h2 class="section-title" title="Take action on your plan">Act</h2>
    <!-- Global Progress Bar (for task completion) -->
    <div class="global-progress-container" title="Overall progress on your actionable items and tasks">
      <div class="global-progress" id="globalProgress" style="width: 0%;"></div>
    </div>

    <!-- Simulation Chart: Shows only "Current" and "Potential" (only counting Completed tasks) -->
    <canvas id="simulationChart" title="Simulation: Current vs. Potential"></canvas>
    
    <!-- Top-Level Tabs: Actionable Items vs. Tasks -->
    <div class="tab-container" id="actTopTabs" title="Switch between Actionable Items and Tasks">
      <div class="tabs" title="Choose between Actionable Items and Tasks">
        <button class="tab-button active" data-tab="actionableItems">Actionable Items</button>
        <button class="tab-button" data-tab="tasks">Tasks</button>
      </div>
      <div id="actionableItems" class="tab-content active">
        <!-- Nested Tabs for Actionable Items -->
        <div class="tab-container" id="actionableNestedTabs" title="Switch between system and coach actionable items">
          <div class="tabs" title="Select view: Arbol, Financial Coach, or All">
            <button class="tab-button active" data-tab="actionableArbol">Arbol</button>
            <button class="tab-button" data-tab="actionableCoach">Financial Coach</button>
            <button class="tab-button" data-tab="actionableAll">All</button>
          </div>
          <div id="actionableArbol" class="tab-content active">
            <h3 title="System-generated actionable items">Actionable Items (Arbol)</h3>
            <!-- Sample Arbol Actionable Items -->
            <div class="action-item" id="action1" data-impact="9" data-saving="1000" data-effort="2" data-urgency="8" title="Click to toggle progress">
              <h4>
                <span class="priority-indicator" title="High impact and low effort">High Impact / Low Effort</span>
                Apply for Pell Grant ($1,000)
              </h4>
              <p title="This will improve your Remaining Balance and Financial Health Score.">
                Securing this grant will increase your funding and improve your Remaining Balance and Financial Health Score.
              </p>
              <p>Due Date: <em>2025-02-28</em></p>
              <button class="action-button" onclick="toggleAction('action1', 'resources1')" title="Mark task as in progress/complete">Start</button>
              <div class="resource-list" id="resources1">
                <h5>Related Resources</h5>
                <ul>
                  <li><a href="#" target="_blank" title="Guide to applying for Pell Grant">Pell Grant Application Guide</a></li>
                  <li><a href="#" target="_blank" title="FAQs about financial aid">Financial Aid FAQ</a></li>
                </ul>
              </div>
            </div>
            <div class="action-item" id="action2" data-impact="8" data-saving="500" data-effort="7" data-urgency="7" title="Click to toggle progress">
              <h4>
                <span class="priority-indicator" title="High impact but requires more effort">High Impact / High Effort</span>
                Review Tuition Fee Waiver Options ($500 Savings)
              </h4>
              <p title="This action will help reduce expenses, improving your Remaining Balance and Financial Health Score.">
                Evaluating tuition fee waiver options can significantly reduce your direct expenses.
              </p>
              <p>Due Date: <em>2025-03-05</em></p>
              <button class="action-button" onclick="toggleAction('action2', 'resources2')" title="Mark task as in progress/complete">Start</button>
              <div class="resource-list" id="resources2">
                <h5>Related Resources</h5>
                <ul>
                  <li><a href="#" target="_blank" title="Check fee waiver eligibility">Tuition Fee Waiver Eligibility</a></li>
                  <li><a href="#" target="_blank" title="Learn how to apply for fee waivers">How to Apply for a Fee Waiver</a></li>
                </ul>
              </div>
            </div>
            <div class="action-item" id="action3" data-impact="6" data-effort="3" data-urgency="6" title="Click to toggle progress">
              <h4>
                <span class="priority-indicator" title="Medium impact and low effort">Medium Impact / Low Effort</span>
                Explore Part-Time Employment Opportunities
              </h4>
              <p title="Supplementing your income will improve your Remaining Balance and Financial Health Score.">
                Research part-time jobs on campus or nearby to supplement your income.
              </p>
              <p>Due Date: <em>2025-03-15</em></p>
              <button class="action-button" onclick="toggleAction('action3', 'resources3')" title="Mark task as in progress/complete">Start</button>
              <div class="resource-list" id="resources3">
                <h5>Related Resources</h5>
                <ul>
                  <li><a href="#" target="_blank" title="Browse on-campus job listings">Campus Job Listings</a></li>
                  <li><a href="#" target="_blank" title="Tips for balancing work and study">Tips for Balancing Work and Study</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div id="actionableCoach" class="tab-content">
            <h3 title="Custom actionable items from your Financial Coach">Actionable Items (Financial Coach)</h3>
            <!-- Sample Coach Actionable Items -->
            <div class="action-item" id="coachAction1" data-impact="8" data-saving="0" data-effort="4" data-urgency="9" title="Click to toggle progress">
              <h4>
                <span class="priority-indicator" title="Coach recommendation">High Importance</span>
                Meet with Your Financial Coach
              </h4>
              <p title="This session will provide personalized guidance to improve your Remaining Balance and Financial Health Score.">
                Schedule a session with your financial coach to review your expenses and discuss custom strategies.
              </p>
              <p>Due Date: <em>2025-02-10</em></p>
              <button class="action-button" onclick="toggleAction('coachAction1', 'resourcesCoach1')" title="Mark task as in progress/complete">Start</button>
              <div class="resource-list" id="resourcesCoach1">
                <h5>Related Resources</h5>
                <ul>
                  <li><a href="#" target="_blank" title="Tips for preparing for a coaching session">Coaching Prep Guide</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div id="actionableAll" class="tab-content">
            <h3 title="Combined actionable items from Arbol and Financial Coach">Actionable Items (All)</h3>
            <!-- Merged Items -->
            <div class="action-item" id="action1All" data-impact="9" data-saving="1000" data-effort="2" data-urgency="8" title="Click to toggle progress">
              <h4>
                <span class="priority-indicator" title="High impact and low effort">High Impact / Low Effort</span>
                Apply for Pell Grant ($1,000)
              </h4>
              <p title="This action will boost your funding, improving your Remaining Balance and Financial Health Score.">
                Securing this grant will increase your funding and improve your Remaining Balance and Financial Health Score.
              </p>
              <p>Due Date: <em>2025-02-28</em></p>
              <button class="action-button" onclick="toggleAction('action1All', 'resources1All')" title="Mark task as in progress/complete">Start</button>
              <div class="resource-list" id="resources1All">
                <h5>Related Resources</h5>
                <ul>
                  <li><a href="#" target="_blank" title="Guide to applying for Pell Grant">Pell Grant Application Guide</a></li>
                </ul>
              </div>
            </div>
            <div class="action-item" id="coachAction1All" data-impact="8" data-saving="0" data-effort="4" data-urgency="9" title="Click to toggle progress">
              <h4>
                <span class="priority-indicator" title="Coach recommendation">High Importance</span>
                Meet with Your Financial Coach
              </h4>
              <p title="This session provides personalized guidance to improve your Remaining Balance and Financial Health Score.">
                Schedule a session with your financial coach to review your plan and receive custom recommendations.
              </p>
              <p>Due Date: <em>2025-02-10</em></p>
              <button class="action-button" onclick="toggleAction('coachAction1All', 'resourcesCoach1All')" title="Mark task as in progress/complete">Start</button>
              <div class="resource-list" id="resourcesCoach1All">
                <h5>Related Resources</h5>
                <ul>
                  <li><a href="#" target="_blank" title="Coaching preparation tips">Coaching Prep Guide</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Tab Content: Tasks (Generic Tasks) -->
      <div id="tasks" class="tab-content">
        <h3 title="Common tasks every college student should complete">Tasks</h3>
        <!-- Task Example 1: Register for Classes -->
        <div class="action-item" id="task1" data-impact="9" data-saving="0" data-effort="3" data-urgency="9" title="Click to toggle progress">
          <h4>
            <span class="priority-indicator" title="Essential for academic progress">High Importance</span>
            Register for Classes
          </h4>
          <p title="Class registration is essential to secure your schedule.">
            Complete your registration by logging into your academic portal and selecting your courses.
          </p>
          <p>Due Date: <em>2025-01-15</em></p>
          <button class="action-button" onclick="toggleAction('task1', 'resourcesTask1')" title="Mark task as in progress/complete">Start</button>
          <div class="resource-list" id="resourcesTask1">
            <h5>Related Resources</h5>
            <ul>
              <li><a href="#" target="_blank" title="Guide to class registration">Class Registration Guide</a></li>
              <li><a href="#" target="_blank" title="FAQs about academic registration">Academic FAQ</a></li>
            </ul>
          </div>
        </div>
        <!-- Task Example 2: Submit Financial Aid Documents -->
        <div class="action-item" id="task2" data-impact="8" data-saving="0" data-effort="4" data-urgency="8" title="Click to toggle progress">
          <h4>
            <span class="priority-indicator" title="Important for securing funding">Important</span>
            Submit Financial Aid Documents
          </h4>
          <p title="Ensure all required documents are submitted on time.">
            Gather and submit your FAFSA and any additional required forms.
          </p>
          <p>Due Date: <em>2025-01-31</em></p>
          <button class="action-button" onclick="toggleAction('task2', 'resourcesTask2')" title="Mark task as in progress/complete">Start</button>
          <div class="resource-list" id="resourcesTask2">
            <h5>Related Resources</h5>
            <ul>
              <li><a href="#" target="_blank" title="Step-by-step FAFSA guide">FAFSA Guide</a></li>
              <li><a href="#" target="_blank" title="Checklist for financial aid documents">Financial Aid Checklist</a></li>
            </ul>
          </div>
        </div>
        <!-- Task Example 3: Set Up a Personal Budget -->
        <div class="action-item" id="task3" data-impact="7" data-saving="0" data-effort="3" data-urgency="7" title="Click to toggle progress">
          <h4>
            <span class="priority-indicator" title="Essential for managing your money">Essential</span>
            Set Up a Personal Budget
          </h4>
          <p title="A personal budget helps you track income and expenses effectively.">
            Use a budgeting tool or spreadsheet to create a monthly budget that tracks your income, fixed costs, and discretionary spending.
          </p>
          <p>Due Date: <em>2025-02-05</em></p>
          <button class="action-button" onclick="toggleAction('task3', 'resourcesTask3')" title="Mark task as in progress/complete">Start</button>
          <div class="resource-list" id="resourcesTask3">
            <h5>Related Resources</h5>
            <ul>
              <li><a href="#" target="_blank" title="Guide to creating a budget">Budgeting 101</a></li>
              <li><a href="#" target="_blank" title="Top budgeting apps for students">Best Budgeting Apps</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Ask Rooty -->
    <div class="chatbot" id="askRooty" title="Get help executing your plan">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Tree_icon.svg/80px-Tree_icon.svg.png" alt="Tree Mascot" class="tree-mascot" title="Your friendly tree mascot" />
      <h3 title="Ask me anything about executing your plan">Ask Rooty</h3>
      <div class="chat-log" id="chatLog">
        <p><strong>Rooty:</strong> Hey there! I’m here to help you execute your action items using your plan and provided resources. What do you need help with to get started?</p>
      </div>
      <div class="predetermined-questions" title="Quick questions to get you started">
        <button onclick="sendPredefined('How do I apply for financial aid?')" title="Learn how to apply for financial aid">How do I apply for financial aid?</button>
        <button onclick="sendPredefined('What tuition fee waiver options are available?')" title="Learn about tuition fee waivers">What tuition fee waiver options are available?</button>
        <button onclick="sendPredefined('How can I manage my living expenses?')" title="Tips on managing expenses">How can I manage my living expenses?</button>
        <button onclick="sendPredefined('What steps should I take next?')" title="Get guidance on next steps">What steps should I take next?</button>
      </div>
      <div class="chat-input">
        <input type="text" id="chatInput" placeholder="Type your question here..." title="Type your question here" />
        <button class="action-button" onclick="sendChat()" title="Send your question">Send</button>
      </div>
    </div>
  </div>
  
  <!-- Resources Section -->
  <div class="container" id="resources-section" title="Helpful tools and guides">
    <h2 class="section-title" title="Tools and guides to support your plan">Resources</h2>
    <div class="carousel" title="Browse through helpful resources">
      <div class="resource-card recommended" title="Highly recommended resource">
        <div class="badge" title="Highly recommended">Recommended</div>
        <h4>Financial Aid Guide</h4>
        <p>A comprehensive guide to applying for financial aid.</p>
        <a href="#" target="_blank" title="Learn more about financial aid">Learn More</a>
      </div>
      <div class="resource-card" title="Explore tuition fee waiver options">
        <h4>Tuition Fee Waivers</h4>
        <p>Explore options to reduce your tuition fees.</p>
        <a href="#" target="_blank" title="Learn more about fee waivers">Learn More</a>
      </div>
      <div class="resource-card recommended" title="Highly recommended resource">
        <div class="badge" title="Highly recommended">Recommended</div>
        <h4>Living Expenses Management</h4>
        <p>Tips and strategies to manage your living expenses effectively.</p>
        <a href="#" target="_blank" title="Learn more about managing living expenses">Learn More</a>
      </div>
      <div class="resource-card" title="Tools to help you budget">
        <h4>Budgeting Tools</h4>
        <p>Find tools to create and manage your personal budget.</p>
        <a href="#" target="_blank" title="Learn more about budgeting tools">Learn More</a>
      </div>
    </div>
  </div>

  <!-- JavaScript Section -->
  <script>
    // Setup tab functionality
    function setupTabs() {
      document.querySelectorAll('.tab-container').forEach(container => {
        const buttons = container.querySelectorAll(':scope > .tabs .tab-button');
        const contents = container.querySelectorAll(':scope > .tab-content');
        buttons.forEach(button => {
          button.addEventListener('click', () => {
            buttons.forEach(btn => btn.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            button.classList.add('active');
            const tabId = button.getAttribute('data-tab');
            const target = container.querySelector(':scope > #' + tabId);
            if (target) target.classList.add('active');
          });
        });
      });
    }
    setupTabs();

    // Update global progress bar (only counting Completed tasks)
    function updateGlobalProgress() {
      const actionItems = document.querySelectorAll('.action-item');
      let completedCount = 0;
      actionItems.forEach(item => {
        if(item.classList.contains('completed')) {
          completedCount++;
        }
      });
      const progressPercent = (completedCount / actionItems.length) * 100;
      document.getElementById('globalProgress').style.width = progressPercent + '%';
    }
    
    // Global variables for simulation
    let currentBalance = -800;
    let currentHealthScore = 6;
    let projBalanceIfCompleted = currentBalance;
    let projHealthIfCompleted = currentHealthScore;
    
    // Compute Financial Health Score based on a projected balance.
    function computeHealthScore(balance) {
      let improvement = balance + 800; // How far the balance is from -800
      let score = 6 + (improvement / 100) * 0.5; // Each $100 improvement adds 0.5 points
      return Math.min(score, 10);
    }
    
    // Create simulation chart with dual axes for two states: "Current" and "Potential"
    const simCtx = document.getElementById('simulationChart').getContext('2d');
    const simulationChart = new Chart(simCtx, {
      type: 'bar',
      data: {
        labels: ['Current', 'Potential'],
        datasets: [
          {
            label: 'Remaining Balance ($)',
            data: [currentBalance, projBalanceIfCompleted],
            backgroundColor: 'rgba(75, 192, 192, 0.6)',
            yAxisID: 'balance'
          },
          {
            label: 'Financial Health Score',
            data: [currentHealthScore, projHealthIfCompleted],
            backgroundColor: 'rgba(39, 174, 96, 0.6)',
            yAxisID: 'health'
          }
        ]
      },
      options: {
        responsive: true,
        scales: {
          balance: {
            type: 'linear',
            position: 'left',
            beginAtZero: false,
            ticks: {
              callback: function(value) {
                return '$' + value;
              }
            },
            title: {
              display: true,
              text: 'Remaining Balance ($)'
            }
          },
          health: {
            type: 'linear',
            position: 'right',
            beginAtZero: true,
            min: 0,
            max: 10,
            title: {
              display: true,
              text: 'Financial Health Score'
            },
            grid: {
              drawOnChartArea: false
            }
          }
        }
      }
    });
    
    // Update projections: only count tasks marked "Completed" using their data-saving attribute (if provided)
    function updateProjections() {
      let completedSaving = 0;
      document.querySelectorAll('.action-item').forEach(item => {
        const btnText = item.querySelector('button.action-button').textContent.trim();
        if(btnText === 'Completed') {
          let savingAttr = item.getAttribute('data-saving');
          if(savingAttr) {
            completedSaving += Number(savingAttr);
          } else {
            // fallback: multiply data-impact by 100 if no data-saving provided
            completedSaving += Number(item.getAttribute('data-impact')) * 100;
          }
        }
      });
      
      projBalanceIfCompleted = currentBalance + completedSaving;
      projHealthIfCompleted = computeHealthScore(projBalanceIfCompleted);
      
      simulationChart.data.datasets[0].data = [currentBalance, projBalanceIfCompleted];
      simulationChart.data.datasets[1].data = [currentHealthScore, projHealthIfCompleted];
      
      // Adjust y-axis for balance with some padding
      let balanceMin = Math.min(currentBalance, projBalanceIfCompleted);
      let balanceMax = Math.max(currentBalance, projBalanceIfCompleted);
      simulationChart.options.scales.balance.suggestedMin = balanceMin - 100;
      simulationChart.options.scales.balance.suggestedMax = balanceMax + 100;
      
      simulationChart.update();
    }
    
    // Toggle action item state
    function toggleAction(itemId, resourcesId) {
      const actionItem = document.getElementById(itemId);
      const button = actionItem.querySelector('button.action-button');
      const resourceList = document.getElementById(resourcesId);
      const currentText = button.textContent.trim();
      if (currentText === 'Start') {
        button.textContent = 'In Progress';
        resourceList.style.display = 'block';
      } else if (currentText === 'In Progress') {
        button.textContent = 'Completed';
        actionItem.classList.add('completed');
      } else {
        button.textContent = 'Start';
        actionItem.classList.remove('completed');
        resourceList.style.display = 'none';
      }
      updateGlobalProgress();
      updateProjections();
    }
    
    // Toggle sub-values for observation details
    function toggleSubValues(iconElement) {
      const dataItem = iconElement.parentElement;
      const subValues = dataItem.querySelector('.sub-values');
      if (subValues) {
        if (subValues.style.display === 'block') {
          subValues.style.display = 'none';
          iconElement.innerHTML = '&#x25B6;';
        } else {
          subValues.style.display = 'block';
          iconElement.innerHTML = '&#x25BC;';
        }
      }
    }
    
    // Chatbot messaging functions
    function appendChatMessage(sender, message) {
      const chatLog = document.getElementById('chatLog');
      const msgElem = document.createElement('p');
      msgElem.innerHTML = '<strong>' + sender + ':</strong> ' + message;
      chatLog.appendChild(msgElem);
      chatLog.scrollTop = chatLog.scrollHeight;
    }
    function sendChat() {
      const input = document.getElementById('chatInput');
      const userMessage = input.value.trim();
      if (userMessage !== '') {
        appendChatMessage('You', userMessage);
        setTimeout(() => {
          appendChatMessage('Rooty', 'Based on your current plan and provided resources, let’s work together to execute your next step.');
        }, 800);
        input.value = '';
      }
    }
    function sendPredefined(question) {
      appendChatMessage('You', question);
      setTimeout(() => {
        appendChatMessage('Rooty', 'Based on your current plan and provided resources, here is some guidance to help you execute this step: [Detailed answer for "' + question + '"]');
      }, 800);
    }
    
    // Create gauge chart for Financial Health Score (static)
    const gaugeCtx = document.getElementById('healthGauge').getContext('2d');
    const healthScore = 6;
    const gaugeChart = new Chart(gaugeCtx, {
      type: 'doughnut',
      data: {
        datasets: [{
          data: [healthScore, 10 - healthScore],
          backgroundColor: ['#27ae60', '#ececec'],
          borderWidth: 0
        }]
      },
      options: {
        rotation: -Math.PI,
        circumference: Math.PI,
        cutout: '70%',
        plugins: {
          legend: { display: false },
          tooltip: {
            enabled: true,
            callbacks: { label: () => 'Financial Health: ' + healthScore + '/10' }
          }
        }
      },
      plugins: [{
        afterDraw: function(chart) {
          const ctx = chart.ctx;
          const chartArea = chart.chartArea;
          const centerX = (chartArea.left + chartArea.right) / 2;
          const centerY = chartArea.bottom;
          const angle = Math.PI * (1 - (healthScore / 10));
          const needleLength = (chartArea.bottom - chartArea.top) * 0.9;
          ctx.save();
          ctx.translate(centerX, centerY);
          ctx.rotate(-angle);
          ctx.beginPath();
          ctx.moveTo(0, 10);
          ctx.lineTo(0, -needleLength);
          ctx.lineWidth = 3;
          ctx.strokeStyle = '#444';
          ctx.stroke();
          ctx.restore();
          ctx.beginPath();
          ctx.arc(centerX, centerY, 5, 0, Math.PI * 2);
          ctx.fillStyle = '#444';
          ctx.fill();
          // Draw the score text in the center
          ctx.fillStyle = '#000';
          ctx.font = 'bold 20px Roboto';
          ctx.textAlign = 'center';
          ctx.fillText(healthScore + '/10', centerX, centerY - 10);
          ctx.font = '12px Roboto';
          ctx.fillText('Index: 1 to 10', centerX, centerY + 15);
        }
      }]
    });
    
    // Update remaining balance text display
    document.getElementById('remainingBalance2').textContent = (currentBalance >= 0 ? '+' : '-') + '$' + Math.abs(currentBalance);
    
    // Chart 1: College Bill Breakdown
    const ctxCollegeBill = document.getElementById('chartCollegeBill').getContext('2d');
    const chartCollegeBill = new Chart(ctxCollegeBill, {
      type: 'bar',
      data: {
        labels: ['College Bill'],
        datasets: [{
          label: 'Direct Funding (Financial Aid)',
          data: [1000],
          backgroundColor: 'rgba(54, 162, 235, 0.6)',
          borderColor: 'rgba(54, 162, 235, 1)',
          borderWidth: 1
        },{
          label: 'Direct Expenses (Tuition & Fees)',
          data: [2000],
          backgroundColor: 'rgba(255, 99, 132, 0.6)',
          borderColor: 'rgba(255, 99, 132, 1)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        scales: {
          x: { stacked: true },
          y: { stacked: true, beginAtZero: true }
        },
        plugins: { legend: { position: 'bottom' } }
      }
    });
    
    // Chart 2: Remaining Balance Breakdown
    const ctxRemaining = document.getElementById('chartRemaining').getContext('2d');
    const chartRemaining = new Chart(ctxRemaining, {
      type: 'bar',
      data: {
        labels: ['Total Inflows'],
        datasets: [{
          label: 'Outflows',
          data: [3800],
          backgroundColor: 'rgba(255, 159, 64, 0.6)'
        },{
          label: 'Remaining Balance',
          data: [currentBalance],
          backgroundColor: 'rgba(75, 192, 192, 0.6)'
        }]
      },
      options: {
        responsive: true,
        scales: {
          x: { stacked: true },
          y: { stacked: true, beginAtZero: true }
        },
        plugins: { legend: { position: 'bottom' } }
      }
    });
    
    // Chart 3: Capacity Comparison
    const ctxCapacity = document.getElementById('chartCapacity').getContext('2d');
    const chartCapacity = new Chart(ctxCapacity, {
      type: 'bar',
      data: {
        labels: ['Current Capacity', 'Max Capacity'],
        datasets: [{
          label: 'Amount ($)',
          data: [3000, 4000],
          backgroundColor: ['rgba(153, 102, 255, 0.6)','rgba(255, 205, 86, 0.6)'],
          borderColor: ['rgba(153, 102, 255, 1)','rgba(255, 205, 86, 1)'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        scales: { y: { beginAtZero: true } },
        plugins: { legend: { display: false } }
      }
    });
    
    // Chart 4: Living Expenses Breakdown (Pie Chart)
    const ctxLivingExpenses = document.getElementById('chartLivingExpenses').getContext('2d');
    const chartLivingExpenses = new Chart(ctxLivingExpenses, {
      type: 'pie',
      data: {
        labels: ['Rent', 'Food', 'Transportation', 'Misc'],
        datasets: [{
          data: [800, 500, 300, 200],
          backgroundColor: [
            'rgba(255, 99, 132, 0.6)',
            'rgba(255, 159, 64, 0.6)',
            'rgba(255, 205, 86, 0.6)',
            'rgba(75, 192, 192, 0.6)'
          ]
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { position: 'bottom' } }
      }
    });
    
    // Chart 5: Funding Breakdown (Pie Chart)
    const ctxFunding = document.getElementById('chartFunding').getContext('2d');
    const chartFunding = new Chart(ctxFunding, {
      type: 'pie',
      data: {
        labels: ['Financial Aid', 'Employment Income', 'Family & Friend Support'],
        datasets: [{
          data: [1000, 1000, 1000],
          backgroundColor: [
            'rgba(54, 162, 235, 0.6)',
            'rgba(255, 206, 86, 0.6)',
            'rgba(75, 192, 192, 0.6)'
          ]
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { position: 'bottom' } }
      }
    });
  </script>
</body>
</html>
